library(ape)
library(caper)
library(tidyverse)
library(phytools)

#read in tree
tree <- read.tree(text = "(((((1:0.619122,2:0.619122):0.617801,(3:0.615446,4:0.615446):0.621477):0.550836,(5:1.415752,6:1.415752):0.372007):1.104319,(7:2.271417,8:2.271417):0.620659):0.71217,(((((9:2.447721,(10:1.418751,(11:1.406489,(((((12:0.612764,(13:0.48242,14:0.48242):0.130344):0.524653,((15:0.601124,16:0.601124):0.22195,17:0.823073):0.314344):0.13666,(((18:1.000001,19:1.000001):0.238626,(((20:0.634933,21:0.634933):0.491156,22:1.126088):0.023914,(((23:0.766978,(24:0.709445,(25:0.31043,26:0.31043):0.399015):0.057535):0.111102,27:0.878079):0.123671,(28:0.754287,29:0.754287):0.247463):0.148253):0.088626):0.013922,(((30:0.226452,31:0.226452):0.273728,(32:0.382178,(33:0.245052,34:0.245052):0.137126):0.118002):0.1661,35:0.666277):0.586271):0.021528):0.018484,36:1.292557):0.031097,(37:0.495967,38:0.495967):0.827687):0.082837):0.012263):1.02897):0.559769,39:3.007489):0.495538,(((((40:2.010147,41:2.010147):0.77792,42:2.788066):0.465055,(43:2.89546,(44:1.331184,45:1.331184):1.564277):0.35766):0.169371,(((((46:1.205173,47:1.205173):0.626226,48:1.831398):0.473659,(((49:1.703345,((50:0.370676,51:0.370676):1.109659,((52:1.060907,53:1.060907):0.17655,(54:0.911234,55:0.911234):0.326223):0.242879):0.223012):0.385318,(56:1.89691,(57:1.785675,58:1.785675):0.111236):0.191754):0.144893,((59:1.344776,60:1.344776):0.546109,(61:0.763737,62:0.763737):1.127148):0.342672):0.071503):0.116825,(63:1.697927,(64:0.803529,65:0.803529):0.894399):0.723955):0.521862,((66:0.537202,67:0.537202):1.7406,(((68:0.341261,69:0.341261):0.284045,70:0.625305):0.984165,71:1.609469):0.668332):0.665942):0.478749):0.059618,(72:2.200001,((73:1.453882,(74:1.182244,75:1.182244):0.271639):0.042074,(76:1.475076,((((77:0.188908,(78:0.099656,79:0.099656):0.089253):0.047338,80:0.236245):0.033791,(81:0.227553,82:0.227553):0.042483):0.088213,83:0.358247):1.11683):0.02088):0.704046):1.282107):0.020919):0.065395,((((84:1.643455,85:1.643455):1.356547,86:3.000001):0.449325,((87:2.176971,(88:2.011675,89:2.011675):0.165297):0.345023,(90:1.381599,(91:1.285397,92:1.285397):0.096202):1.140396):0.927333):0.114184,((93:3.341004,((((94:0.998896,((95:0.722775,96:0.722775):0.125625,97:0.848399):0.150498):0.407625,98:1.406521):0.301957,99:1.708477):0.508148,((100:0.745807,101:0.745807):0.973238,(102:1.144097,103:1.144097):0.574949):0.49758):1.124381):0.128845,((((104:3.081147,(105:2.738223,(106:1.848808,107:1.848808):0.889415):0.342925):0.134203,((108:1.279134,(109:0.914439,(110:0.789865,111:0.789865):0.124575):0.364695):1.835374,((112:1.927942,((113:1.043495,114:1.043495):0.231512,115:1.275005):0.652937):0.707925,((116:0.925687,117:0.925687):0.317767,(118:0.674411,119:0.674411):0.569042):1.392415):0.478641):0.100843):0.145983,((120:2.29559,(121:1.895628,(122:1.2473,123:1.2473):0.64833):0.399963):0.689518,(124:2.928249,((125:1.975077,(126:1.573937,127:1.573937):0.401142):0.611467,(128:2.006041,129:2.006041):0.580503):0.341707):0.056861):0.376224):0.032782,130:3.394112):0.075737):0.093662):0.004911):0.031583,((131:3.505869,((132:1.88182,133:1.88182):0.482313,134:2.364132):1.141737):0.007811,(((((135:2.823381,136:2.823381):0.42146,(137:2.651958,138:2.651958):0.592883):0.074615,139:3.319453):0.022924,((140:1.092486,(141:0.688237,142:0.688237):0.40425):0.448374,143:1.540859):1.801519):0.139419,((144:2.729975,(145:2.367374,146:2.367374):0.362602):0.299223,(((((147:0.766499,148:0.766499):0.81334,(149:1.205277,150:1.205277):0.374562):0.759979,(151:0.869135,152:0.869135):1.470682):0.306906,153:2.64672):0.104287,(154:1.932597,155:1.932597):0.81841):0.278192):0.452599):0.031886):0.086323):0.004244);")

tips_outlier <- c(8)
tips_sister_a <-  c(8,7)
tips_sister_b <-  c(96, 95)
tips_sister_c <-  c(142, 141)
triplets_a <- c(144, 145, 146)
triplets_b <- c(142, 141, 140)
triplets_c <- c(79, 78, 77)
quadruplets_a <- c(150, 149, 148, 147)
quadruplets_b <- c(1, 2, 3, 4)
quadruplets_c <- c(119, 118, 117, 116)
quintuplets_a <- 
tips_cluster <- c(39, 9, 10, 11, 38, 37, 17, 16, 15, 12, 14, 13, 35, 31, 30, 32, 34, 33, 19, 18, 22, 21, 20, 29, 28 ,27, 23, 24, 26, 25)


#clustered= c(rep(x = 1, times = 62), rep(x = 0, times = 48)),

df <- tree$tip.label %>%
  as.data.frame() %>%
  rename(tip.label = ".") %>% 
  mutate(outlier_end = ifelse(tip.label == "8", 0, 1),  
         outlier_middle = c(rep(x = 1, times = 77), 0, rep(x = 1, times = 77) ))
  
df$cluster <- ifelse(df$tip.label %in% tips_cluster, 0, 1)
df$outlier_random <- sample(df$outlier_end)
df$cluster_random <- sample(df$clustered)

png(filename = "tree_plot.png", width = 7, height = 15, units = "in", res = 300)

plotTree(tree, cex = 0.5)
 
x <- dev.off()

